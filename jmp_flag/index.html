
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Writeup for challenge "Jmp flag" of Down Under CTF 2024">
      
      
      
      
        <link rel="prev" href="../rusty/">
      
      
        <link rel="next" href="../pac_shell/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Jmp flag writeup - DU CTF 2024</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prologue" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DU CTF 2024" class="md-header__button md-logo" aria-label="DU CTF 2024" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DU CTF 2024
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Jmp flag writeup
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/sukolenvo/2024duCTF" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DU CTF 2024" class="md-nav__button md-logo" aria-label="DU CTF 2024" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    DU CTF 2024
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sukolenvo/2024duCTF" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DownUnderCTF 2024 Writeups
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../shufflebox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shufflebox
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../number_mashing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Number mashing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../transmissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intercepted transmissions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vector overflow
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../decrypt_eval/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decrypt then eval
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../yawa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yawa
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dna/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNAdecay
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sign_in/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sign in
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sssshhhh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sssshhhh
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rusty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rusty vault
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Jmp flag
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Jmp flag
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prologue" class="md-nav__link">
    <span class="md-ellipsis">
      Prologue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#my-struggle" class="md-nav__link">
    <span class="md-ellipsis">
      My struggle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="My struggle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#epilogue" class="md-nav__link">
    <span class="md-ellipsis">
      Epilogue
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pac_shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pac shell
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prologue" class="md-nav__link">
    <span class="md-ellipsis">
      Prologue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#my-struggle" class="md-nav__link">
    <span class="md-ellipsis">
      My struggle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="My struggle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#epilogue" class="md-nav__link">
    <span class="md-ellipsis">
      Epilogue
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/sukolenvo/2024duCTF/edit/master/docs/jmp_flag/index.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


  <h1>Jmp flag</h1>

<h2 id="prologue">Prologue<a class="headerlink" href="#prologue" title="Permanent link">&para;</a></h2>
<p>Difficulty: easy</p>
<p>Category: reverse engineering</p>
<p>Solved: 71</p>
<div class="admonition quote">
<p class="admonition-title">Description</p>
<p>The flag is just a hop, a skip and a jump away.</p>
</div>
<p>Input files:</p>
<ul>
<li><a href="https://github.com/DownUnderCTF/Challenges_2024_Public/blob/f2797a33d8f5851508f37e854afceedf85eee8a3/rev/jmp-flag/publish/jmp_flag">jmp_flag binary</a></li>
</ul>
<p>NB:</p>
<ul>
<li>
<p>Following indices bases system is used to avoid ambiguity. Whenever element of a collection is referenced by <strong>number</strong>, 0-based index implied. </p>
<p>Ie, element <code>0</code> of list <code>[1, 2, 4, 8, 16]</code> is <code>1</code>, Element <code>3</code> is <code>8</code>.</p>
<p>When element is reference in explanation with <strong>word</strong> (first, third...), 1-based system is implied.</p>
<p>Ie, first character of string <code>Hello World!</code> is <code>H</code>, fifth is <code>o</code>.</p>
</li>
</ul>
<ul>
<li>Solution code was redacted for readability purposes. Due to time pressure during the competition I was using a lot of one-letter variables and questionable code structure.</li>
</ul>
<ul>
<li>I am using gdb with <a href="https://github.com/pwndbg/pwndbg">pwndbg</a> plugin</li>
</ul>
<h2 id="my-struggle">My struggle<a class="headerlink" href="#my-struggle" title="Permanent link">&para;</a></h2>
<h3 id="analysis">Analysis<a class="headerlink" href="#analysis" title="Permanent link">&para;</a></h3>
<p>Running the binary doesn't reveal much:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>$<span class="w"> </span>./jmp_flag<span class="w">   </span>
aaaaa
Incorrect!
</code></pre></div></td></tr></table></div>
<p>Let open <a href="https://ghidra-sre.org/">Ghidra</a>. First thing is to understand the flow of the program: <code>entry</code> function is language
generated wrapper. And program specific code starts with function <code>FUN_00105300</code>:</p>
<div class="language-c highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">protram entrypoint</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">undefined8</span><span class="w"> </span><span class="nf">FUN_00105300</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&quot;%64s&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_58</span><span class="p">);</span><span class="w">                                     </span><span class="err">#</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">local_58</span><span class="w"> </span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">local_5c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">local_5c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">0x40</span><span class="p">;</span><span class="w"> </span><span class="n">local_5c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_5c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">iterate</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">64</span>
<span class="w">    </span><span class="n">FUN_00101280</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)((</span><span class="kt">long</span><span class="p">)</span><span class="o">&amp;</span><span class="n">local_58</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">local_5c</span><span class="p">));</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">FUN_00101280</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">time</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">iVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FUN_00101200</span><span class="p">();</span><span class="w">                                               </span><span class="err">#</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">something</span><span class="o">?</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iVar1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;Incorrect!&quot;</span><span class="p">);</span><span class="w">                                                 </span><span class="err">#</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">wrong</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Correct! DUCTF{%s}</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_58</span><span class="p">);</span><span class="w">                           </span><span class="err">#</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">local_58</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">flag</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>On success program prints out our input - this means we won't find the flag in the binary. Instead, our goal is to find
input that would satisfy algorithm encoded in the program.</p>
<div class="language-c highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">win check function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">bool</span><span class="w"> </span><span class="nf">FUN_00101200</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">DAT_00109010</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Function that check if answer is correct or not is very short: our task is to make sure global variable DAT_00109010 is 0. 
Note that that that DAT_00109010 is 8 byte value with initial value 0xFFFFFFFFFFFFFFFF.</p>
<div class="language-c highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">loop function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">FUN_00101280</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">param_1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">FUN_00101300</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">param_1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mh">0x80</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">))();</span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>As we can see this function that is also very short: it converts character that we enter into number (ascii)
then multiplies is by 0x80 and uses it as on offset to jump to (base address is 0x00101300). Depending on character,
it would jump to:</p>
<table>
<thead>
<tr>
<th><strong>ascii value</strong></th>
<th><strong>address</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>FUN_00101300 + 0</td>
</tr>
<tr>
<td>0x01</td>
<td>FUN_00101300 + 0x80</td>
</tr>
<tr>
<td>0x02</td>
<td>FUN_00101300 + 0x100</td>
</tr>
<tr>
<td>0x03</td>
<td>FUN_00101300 + 0x180</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>(I ignored +4 in the formula for now for readability purposes - its constant it doesn't change much).</p>
<p>Lets see what is at those addresses. I can see few different type of functions:</p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// there are a lot of functions that are just setting global DAT_00109010 to 0xffffff</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">FUN_00101300</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">DAT_00109010</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xffffffffffffffff</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// there are also functions that do `and` comparison of the global and if result is 0 - xors global with a constant</span>
<span class="n">ulong</span><span class="w"> </span><span class="nf">FUN_00102b80</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">ulong</span><span class="w"> </span><span class="n">uVar1</span><span class="p">;</span>
<span class="w">  </span><span class="n">uVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DAT_00109010</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x1000002020000</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uVar1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">uVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DAT_00109010</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mh">0x40000</span><span class="p">;</span>
<span class="w">    </span><span class="n">DAT_00109010</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">uVar1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>As a first step I went through all functions and extracted test constants and xor values:</p>
<details class="info">
<summary>extracted constants</summary>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">actions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mh">0x77ffdfecdeefdffe</span><span class="p">,</span> <span class="mh">0x200000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffdfeedeeffffe</span><span class="p">,</span> <span class="mh">0x200000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c2c7c1de</span><span class="p">,</span> <span class="mh">0x200</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cc6efc3de</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75c9502402c7c1de</span><span class="p">,</span> <span class="mh">0x40000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x2000000</span><span class="p">,</span> <span class="mh">0x20000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d9512cc6efc3de</span><span class="p">,</span> <span class="mh">0x2000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffdfecceefdffe</span><span class="p">,</span> <span class="mh">0x10000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x408100200286804c</span><span class="p">,</span> <span class="mh">0x400000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fffffedeeffffe</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x81000002060000</span><span class="p">,</span> <span class="mh">0x800000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffffffdfefffff</span><span class="p">,</span> <span class="mh">0x8000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x1000002060000</span><span class="p">,</span> <span class="mh">0x80000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cc6efd3de</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x71c9502402c7c1de</span><span class="p">,</span> <span class="mh">0x400000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x81000002860000</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c6efc3de</span><span class="p">,</span> <span class="mh">0x10000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c7814c</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0xf7ffffffffefffff</span><span class="p">,</span> <span class="mh">0x800000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x71c9002402c7c1de</span><span class="p">,</span> <span class="mh">0x400000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002402c7c1de</span><span class="p">,</span> <span class="mh">0x100000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c781cc</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75c95024c2c7c1de</span><span class="p">,</span> <span class="mh">0x10000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x1000002020000</span><span class="p">,</span> <span class="mh">0x40000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffffeedeeffffe</span><span class="p">,</span> <span class="mh">0x1000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c6814c</span><span class="p">,</span> <span class="mh">0x10000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6081002002c6814c</span><span class="p">,</span> <span class="mh">0x8000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95124c6efc3de</span><span class="p">,</span> <span class="mh">0x800000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff57acceefd7fe</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081002002c6804c</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c6cfc3de</span><span class="p">,</span> <span class="mh">0x200000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081000002868048</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x71c9402402c7c1de</span><span class="p">,</span> <span class="mh">0x100000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x2020000</span><span class="p">,</span> <span class="mh">0x1000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff57ecceefdffe</span><span class="p">,</span> <span class="mh">0x800000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002402c7c1dc</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffdfeedeefdffe</span><span class="p">,</span> <span class="mh">0x2000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cceefd3fe</span><span class="p">,</span> <span class="mh">0x20000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c781dc</span><span class="p">,</span> <span class="mh">0x40000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x408100000286804c</span><span class="p">,</span> <span class="mh">0x2000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081000002860008</span><span class="p">,</span> <span class="mh">0x8000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002002c781dc</span><span class="p">,</span> <span class="mh">0x4000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c2c7c3de</span><span class="p">,</span> <span class="mh">0x4000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cc6efd3fe</span><span class="p">,</span> <span class="mh">0x8000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081000002868008</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db532cceefd3fe</span><span class="p">,</span> <span class="mh">0x20000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75c9502442c7c1de</span><span class="p">,</span> <span class="mh">0x80000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0xffffffffffefffff</span><span class="p">,</span> <span class="mh">0x100000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fb532cceefd3fe</span><span class="p">,</span> <span class="mh">0x400</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff57acceefdffe</span><span class="p">,</span> <span class="mh">0x4000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c6c7c3de</span><span class="p">,</span> <span class="mh">0x80000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x60c9002002c781dc</span><span class="p">,</span> <span class="mh">0x1000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x2000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fffffedeefffff</span><span class="p">,</span> <span class="mh">0x1000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002002c7c1dc</span><span class="p">,</span> <span class="mh">0x400000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0xf7ffffffdfefffff</span><span class="p">,</span> <span class="mh">0x20000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fb532cceefd7fe</span><span class="p">,</span> <span class="mh">0x4000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff53acceefd7fe</span><span class="p">,</span> <span class="mh">0x40000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffd7ecceefdffe</span><span class="p">,</span> <span class="mh">0x80000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x81000002860008</span><span class="p">,</span> <span class="mh">0x4000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff532cceefd7fe</span><span class="p">,</span> <span class="mh">0x8000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081002002c6814c</span><span class="p">,</span> <span class="mh">0x2000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fffffedfefffff</span><span class="p">,</span> <span class="mh">0x100000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75d95024c2c7c1de</span><span class="p">,</span> <span class="mh">0x200000000000000</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div></td></tr></table></div>
</details>
<p>I can see that there are 64 functions. Each one unsets one specific bit (different for all of them) and also has a different
test constant. Because unset bit is always different we have to call all of them exactly once. Here are few first steps of the program:</p>
<ol>
<li>We start with global value 0xFFFFFFFFFFFFFFFF </li>
<li>Only one function can be executed (test for other functions fails): line 54 [0, 0x2000000]</li>
<li>Now we have global value 0xFFFFFFFFFDFFFFFF </li>
<li>Only one new function can be executed (test for other functions fails): line 7 [0x2000000, 0x20000]</li>
<li>Now we have global value 0xFFFFFFFFFDFDFFFF</li>
<li>Only one new function can be executed (test for other functions fails): line 35 [0x2020000, 0x1000000000000]</li>
<li>and so on</li>
</ol>
<p>So, there is only one specific order in which we can call this functions to unset all bits and get global value to 0.</p>
<h3 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">&para;</a></h3>
<p>We can get find the order in which functions should be executed:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">order functions</label><label for="__tabbed_1_2">output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># reorder all functions to be sorted in order that should be executed</span>
<span class="c1"># function is array where first number is test value of the function and second number is bit that it sets</span>
<span class="k">def</span> <span class="nf">order_functions</span><span class="p">(</span><span class="n">functions</span><span class="p">):</span>
    <span class="c1"># keep track of bits we have unset so far</span>
    <span class="n">bits_processed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ordered</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># result</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
            <span class="c1"># if function&#39;s test number matches bits that were unset - this function should be executed next</span>
            <span class="k">if</span> <span class="n">function</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">bits_processed</span><span class="p">:</span>
                <span class="c1"># update bits set</span>
                <span class="n">bits_processed</span> <span class="o">+=</span> <span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1"># add this function to the end of result</span>
                <span class="n">ordered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">ordered</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">test</span><span class="o">=</span><span class="mh">0x0</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x2000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x2000000</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x20000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x2020000</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x1000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x1000002020000</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x40000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x1000002060000</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x80000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x81000002060000</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x800000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x81000002860000</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x8</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x81000002860008</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x4000000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x4081000002860008</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x8000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x4081000002868008</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x40</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x4081000002868048</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x4</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x408100000286804c</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x2000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x408100200286804c</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x400000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x4081002002c6804c</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x100</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x4081002002c6814c</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x2000000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x6081002002c6814c</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x8000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x6089002002c6814c</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x10000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x6089002002c7814c</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x80</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x6089002002c781cc</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x10</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x6089002002c781dc</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x40000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x60c9002002c781dc</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x1000000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x70c9002002c781dc</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x4000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x70c9002002c7c1dc</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x400000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x70c9002402c7c1dc</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x2</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x70c9002402c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x100000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x71c9002402c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x400000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x71c9402402c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x100000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x71c9502402c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x400000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x75c9502402c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x40000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x75c9502442c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x80000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x75c95024c2c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x10000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x75d95024c2c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x200000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77d95024c2c7c1de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x200</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77d95024c2c7c3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x4000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77d95024c6c7c3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x80000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77d95024c6cfc3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x200000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77d95024c6efc3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x10000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77d95124c6efc3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x800000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77d9512cc6efc3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x2000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77db512cc6efc3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x1000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77db512cc6efd3de</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x20</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77db512cc6efd3fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x8000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77db512cceefd3fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x20000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77db532cceefd3fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x20000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77fb532cceefd3fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x400</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77fb532cceefd7fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x4000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ff532cceefd7fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x8000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ff53acceefd7fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x40000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ff57acceefd7fe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x800</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ff57acceefdffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x4000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ff57ecceefdffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x800000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ffd7ecceefdffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x80000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ffdfecceefdffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x10000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ffdfecdeefdffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x200000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ffdfeedeefdffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x2000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ffdfeedeeffffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x200000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ffffeedeeffffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x1000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77fffffedeeffffe</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x1</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77fffffedeefffff</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x1000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77fffffedfefffff</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x100000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0x77ffffffdfefffff</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x8000000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0xf7ffffffdfefffff</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x20000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0xf7ffffffffefffff</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x800000000000000</span>
<span class="n">test</span><span class="o">=</span><span class="mh">0xffffffffffefffff</span> <span class="n">xor_value</span><span class="o">=</span><span class="mh">0x100000</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>Now we need to find out what offset corresponds to each function. I don't have it yet and not looking to map each 64 values manually.
Therefore, I wrote a script for that:</p>
<ol>
<li>calculate address we jump for a character;</li>
<li>disassemble function at address from step 1. Sample output
   <div class="language-asm highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w"> </span><span class="nf">f3</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">e</span><span class="w"> </span><span class="no">fa</span><span class="w">             </span><span class="no">endbr64</span>
<span class="w"> </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="no">rbp</span>
<span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span>
<span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">81</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rip</span><span class="err">+</span><span class="mi">0x4c81</span><span class="p">]</span><span class="w">        </span>
<span class="hll"><span class="w"> </span><span class="mi">48</span><span class="w"> </span><span class="no">ba</span><span class="w"> </span><span class="no">de</span><span class="w"> </span><span class="no">c1</span><span class="w"> </span><span class="no">c7</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="no">c9</span><span class="w"> </span><span class="mi">71</span><span class="w">   </span><span class="no">movabs</span><span class="w"> </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="mi">0x71c9402402c7c1de</span>
</span><span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">21</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">and</span><span class="w">    </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">rdx</span>
<span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">rax</span>
<span class="w"> </span><span class="err">75</span><span class="w"> </span><span class="err">27</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mi">0x48</span>
<span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">68</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rip</span><span class="err">+</span><span class="mi">0x4c68</span><span class="p">]</span><span class="w">        </span>
<span class="hll"><span class="w"> </span><span class="mi">48</span><span class="w"> </span><span class="no">ba</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">   </span><span class="no">movabs</span><span class="w"> </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="mi">0x100000000000</span>
</span><span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">31</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">xor</span><span class="w">    </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">rdx</span>
<span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">05</span><span class="w"> </span><span class="err">54</span><span class="w"> </span><span class="err">4</span><span class="nf">c</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rip</span><span class="err">+</span><span class="mi">0x4c54</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w">     </span>
<span class="w"> </span><span class="mi">48</span><span class="w"> </span><span class="mi">8</span><span class="no">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">4</span><span class="no">d</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rip</span><span class="err">+</span><span class="mi">0x4c4d</span><span class="p">]</span><span class="w">   </span>
<span class="w"> </span><span class="mi">48</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">rax</span>
<span class="w"> </span><span class="nf">eb</span><span class="w"> </span><span class="mi">01</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mi">0x49</span>
<span class="w"> </span><span class="err">90</span><span class="w">                      </span><span class="nf">nop</span>
<span class="w"> </span><span class="err">90</span><span class="w">                      </span><span class="nf">nop</span>
<span class="w"> </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="no">rbp</span>
<span class="w"> </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span>
</code></pre></div></td></tr></table></div></li>
<li>For each function check if test_number and xor_number are in the snippet. Given each function has unique test number and xor value - this
uniquely identifies snippet to function relation. Few values that were not resolved uniquely I handled manually.</li>
</ol>
<p>One thing to point out is that Ghidra decoded idea of function FUN_00101280 correctly, but formula turns out to be slightly
different (this doesn't change logic, just different start address and offset multiplier). Correct values are taken disassembly of <code>FUN_00101280</code>.</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># calculate ascii value that corresponds to each function and store it as a third value in the function</span>
<span class="c1"># As a result each function wil be array of 3 values: test_value, xor_value, ascii_char_value</span>
<span class="k">def</span> <span class="nf">find_offsets</span><span class="p">(</span><span class="n">functions</span><span class="p">):</span>
    <span class="n">elfexe</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/home/kali/Documents/mypy/Downloads/jmp_flag&#39;</span><span class="p">)</span>
    <span class="c1"># corrected base of the jump</span>
    <span class="n">jmp_base</span> <span class="o">=</span> <span class="mh">0x12a4</span>
    <span class="c1"># collect all assembly snippets</span>
    <span class="n">asms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># for each character 1..256</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
        <span class="c1"># corrected formula to calculate offset</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x60</span>
        <span class="c1"># disassemble first 100 bytes of the function</span>
        <span class="n">function_asm</span> <span class="o">=</span> <span class="n">disasm</span><span class="p">(</span><span class="n">elfexe</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">jmp_base</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
        <span class="n">asms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function_asm</span><span class="p">)</span>

    <span class="c1"># find character for each function</span>
    <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
        <span class="c1"># list of possible matching assembly snippets</span>
        <span class="n">matching_asm_snippets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">asm_snippet</span> <span class="ow">in</span> <span class="n">asms</span><span class="p">:</span>
            <span class="c1"># check if snippet contains test value (function[0]) in hex</span>
            <span class="c1"># and contains xor_value (function[1]) in hex (except for small numbers 512, 4096,... as they generate too many falsematches)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">function</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">asm_snippet</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">hex</span><span class="p">(</span><span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">asm_snippet</span> <span class="ow">or</span> <span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">512</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">8192</span><span class="p">,</span> <span class="mi">32768</span><span class="p">,</span> <span class="mi">16384</span><span class="p">,</span> <span class="mi">1024</span><span class="p">]):</span>
                <span class="n">matching_asm_snippets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asm_snippet</span><span class="p">)</span>
        <span class="c1"># if there is only one matching assembly - we good, resolved automatically</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_asm_snippets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">matching_asm_snippets</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="c1"># otherwise some hardcoded values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">131072</span><span class="p">:</span>
                <span class="n">function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">matching_asm_snippets</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">function</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">115</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">matching_asm_snippets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Now that we know character for each function and in what order to enter those characters we just loop through them and print out.
Full script:</p>
<details class="success">
<summary>solve.py</summary>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">actions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mh">0x77ffdfecdeefdffe</span><span class="p">,</span> <span class="mh">0x200000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffdfeedeeffffe</span><span class="p">,</span> <span class="mh">0x200000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c2c7c1de</span><span class="p">,</span> <span class="mh">0x200</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cc6efc3de</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75c9502402c7c1de</span><span class="p">,</span> <span class="mh">0x40000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x2000000</span><span class="p">,</span> <span class="mh">0x20000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d9512cc6efc3de</span><span class="p">,</span> <span class="mh">0x2000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffdfecceefdffe</span><span class="p">,</span> <span class="mh">0x10000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x408100200286804c</span><span class="p">,</span> <span class="mh">0x400000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fffffedeeffffe</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x81000002060000</span><span class="p">,</span> <span class="mh">0x800000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffffffdfefffff</span><span class="p">,</span> <span class="mh">0x8000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x1000002060000</span><span class="p">,</span> <span class="mh">0x80000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cc6efd3de</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x71c9502402c7c1de</span><span class="p">,</span> <span class="mh">0x400000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x81000002860000</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c6efc3de</span><span class="p">,</span> <span class="mh">0x10000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c7814c</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0xf7ffffffffefffff</span><span class="p">,</span> <span class="mh">0x800000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x71c9002402c7c1de</span><span class="p">,</span> <span class="mh">0x400000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002402c7c1de</span><span class="p">,</span> <span class="mh">0x100000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c781cc</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75c95024c2c7c1de</span><span class="p">,</span> <span class="mh">0x10000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x1000002020000</span><span class="p">,</span> <span class="mh">0x40000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffffeedeeffffe</span><span class="p">,</span> <span class="mh">0x1000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c6814c</span><span class="p">,</span> <span class="mh">0x10000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6081002002c6814c</span><span class="p">,</span> <span class="mh">0x8000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95124c6efc3de</span><span class="p">,</span> <span class="mh">0x800000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff57acceefd7fe</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081002002c6804c</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c6cfc3de</span><span class="p">,</span> <span class="mh">0x200000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081000002868048</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x71c9402402c7c1de</span><span class="p">,</span> <span class="mh">0x100000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x2020000</span><span class="p">,</span> <span class="mh">0x1000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff57ecceefdffe</span><span class="p">,</span> <span class="mh">0x800000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002402c7c1dc</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffdfeedeefdffe</span><span class="p">,</span> <span class="mh">0x2000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cceefd3fe</span><span class="p">,</span> <span class="mh">0x20000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x6089002002c781dc</span><span class="p">,</span> <span class="mh">0x40000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x408100000286804c</span><span class="p">,</span> <span class="mh">0x2000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081000002860008</span><span class="p">,</span> <span class="mh">0x8000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002002c781dc</span><span class="p">,</span> <span class="mh">0x4000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c2c7c3de</span><span class="p">,</span> <span class="mh">0x4000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db512cc6efd3fe</span><span class="p">,</span> <span class="mh">0x8000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081000002868008</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77db532cceefd3fe</span><span class="p">,</span> <span class="mh">0x20000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75c9502442c7c1de</span><span class="p">,</span> <span class="mh">0x80000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0xffffffffffefffff</span><span class="p">,</span> <span class="mh">0x100000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fb532cceefd3fe</span><span class="p">,</span> <span class="mh">0x400</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff57acceefdffe</span><span class="p">,</span> <span class="mh">0x4000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77d95024c6c7c3de</span><span class="p">,</span> <span class="mh">0x80000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x60c9002002c781dc</span><span class="p">,</span> <span class="mh">0x1000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x2000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fffffedeefffff</span><span class="p">,</span> <span class="mh">0x1000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x70c9002002c7c1dc</span><span class="p">,</span> <span class="mh">0x400000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0xf7ffffffdfefffff</span><span class="p">,</span> <span class="mh">0x20000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fb532cceefd7fe</span><span class="p">,</span> <span class="mh">0x4000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff53acceefd7fe</span><span class="p">,</span> <span class="mh">0x40000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ffd7ecceefdffe</span><span class="p">,</span> <span class="mh">0x80000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x81000002860008</span><span class="p">,</span> <span class="mh">0x4000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77ff532cceefd7fe</span><span class="p">,</span> <span class="mh">0x8000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x4081002002c6814c</span><span class="p">,</span> <span class="mh">0x2000000000000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x77fffffedfefffff</span><span class="p">,</span> <span class="mh">0x100000000</span><span class="p">],</span>
    <span class="p">[</span><span class="mh">0x75d95024c2c7c1de</span><span class="p">,</span> <span class="mh">0x200000000000000</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># calculate ascii value that corresponds to each function and store it as a third value in the function</span>
<span class="c1"># As a result each function wil be array of 3 values: test_value, xor_value, ascii_char_value</span>
<span class="k">def</span> <span class="nf">find_offsets</span><span class="p">(</span><span class="n">functions</span><span class="p">):</span>
    <span class="n">elfexe</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/home/kali/Documents/mypy/Downloads/jmp_flag&#39;</span><span class="p">)</span>
    <span class="c1"># corrected base of the jump</span>
    <span class="n">jmp_base</span> <span class="o">=</span> <span class="mh">0x12a4</span>
    <span class="c1"># collect all assembly snippets</span>
    <span class="n">asms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># for each character 1..256</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
        <span class="c1"># corrected formula to calculate offset</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x60</span>
        <span class="c1"># disassemble first 100 bytes of the function</span>
        <span class="n">function_asm</span> <span class="o">=</span> <span class="n">disasm</span><span class="p">(</span><span class="n">elfexe</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">jmp_base</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
        <span class="n">asms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function_asm</span><span class="p">)</span>

    <span class="c1"># find character for each function</span>
    <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
        <span class="c1"># list of possible matching assembly snippets</span>
        <span class="n">matching_asm_snippets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">asm_snippet</span> <span class="ow">in</span> <span class="n">asms</span><span class="p">:</span>
            <span class="c1"># check if snippet contains test value (function[0]) in hex</span>
            <span class="c1"># and contains xor_value (function[1]) in hex (except for small numbers 512, 4096,... as they generate too many falsematches)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">function</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">asm_snippet</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">hex</span><span class="p">(</span><span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">asm_snippet</span> <span class="ow">or</span> <span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">512</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">8192</span><span class="p">,</span> <span class="mi">32768</span><span class="p">,</span> <span class="mi">16384</span><span class="p">,</span> <span class="mi">1024</span><span class="p">]):</span>
                <span class="n">matching_asm_snippets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asm_snippet</span><span class="p">)</span>
        <span class="c1"># if there is only one matching assembly - we good, resolved automatically</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_asm_snippets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">matching_asm_snippets</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="c1"># otherwise some hardcoded values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">131072</span><span class="p">:</span>
                <span class="n">function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">matching_asm_snippets</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">function</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">115</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">matching_asm_snippets</span><span class="p">)</span>


<span class="c1"># reorder all functions to be sorted in order that should be executed</span>
<span class="c1"># function is array where first number is test value of the function and second number is bit that it sets</span>
<span class="k">def</span> <span class="nf">order_functions</span><span class="p">(</span><span class="n">functions</span><span class="p">):</span>
    <span class="c1"># keep track of bits we have unset so far</span>
    <span class="n">bits_processed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ordered</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># result</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
            <span class="c1"># if function&#39;s test number matches bits that were unset - this function should be executed next</span>
            <span class="k">if</span> <span class="n">function</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">bits_processed</span><span class="p">:</span>
                <span class="c1"># update bits set</span>
                <span class="n">bits_processed</span> <span class="o">+=</span> <span class="n">function</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1"># add this function to the end of result</span>
                <span class="n">ordered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">ordered</span>


<span class="n">find_offsets</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">order_functions</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
<h2 id="epilogue">Epilogue<a class="headerlink" href="#epilogue" title="Permanent link">&para;</a></h2>
<ul>
<li>Official website: <a href="https://downunderctf.com/">https://downunderctf.com/</a></li>
<li>Official writeups: <a href="https://github.com/DownUnderCTF/Challenges_2024_Public">https://github.com/DownUnderCTF/Challenges_2024_Public</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../rusty/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Rusty vault">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Rusty vault
              </div>
            </div>
          </a>
        
        
          
          <a href="../pac_shell/" class="md-footer__link md-footer__link--next" aria-label="Next: Pac shell">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Pac shell
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.footer", "content.action.edit"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
        <script src="../search/main.js"></script>
      
    
  </body>
</html>